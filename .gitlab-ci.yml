stages:
  - build
  - test
  - cleanup

AndroidBuild:
  stage: build
  script:
    - ./gradlew build
  tags:
    - android

AndroidTest:
  stage: test
  script:
    - emulator -avd test -no-audio -no-window &
    - ./android-wait-for-emulator
    - adb shell input keyevent 82 &
    - ./gradlew connectedAndroidTest
  tags:
     - android

AndroidCleanup:
  stage: cleanup
  when: always
  allow_failure: true
  script:
    - pgrep emulator | xargs kill
  tags:
    - android